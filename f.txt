-- ===== –°–ï–†–í–Ü–°–ò =====
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")

local player = Players.LocalPlayer
local camera = workspace.CurrentCamera

-- ===== –°–¢–ê–ù =====
local espOn = false
local aimOn = false
local guiVisible = true
local highlights = {}

-- ===== GUI =====
local function createGUI()
	if player.PlayerGui:FindFirstChild("GUIHOT") then
		return player.PlayerGui.GUIHOT
	end

	local gui = Instance.new("ScreenGui")
	gui.Name = "GUIHOT"
	gui.ResetOnSpawn = false
	gui.Parent = player.PlayerGui

	local main = Instance.new("Frame", gui)
	main.Size = UDim2.new(0,260,0,280)
	main.Position = UDim2.new(0,20,0.5,-140)
	main.Active = true
	main.Draggable = true

	local title = Instance.new("TextLabel", main)
	title.Size = UDim2.new(1,0,0,40)
	title.Text = "üî• GUIHOT üî•"
	title.TextScaled = true
	title.BackgroundTransparency = 1

	local function btn(text,y)
		local b = Instance.new("TextButton", main)
		b.Size = UDim2.new(1,-20,0,35)
		b.Position = UDim2.new(0,10,0,y)
		b.Text = text
		b.TextScaled = true
		return b
	end

	return {
		gui = gui,
		main = main,
		title = title,
		esp = btn("ESP: OFF",60),
		aim = btn("AIM: OFF",110),
		hide = btn("HIDE / SHOW",200)
	}
end

local UI = createGUI()

-- ===== –¢–ï–ú–ò =====
local themes = {
	{bg=Color3.fromRGB(10,10,30), text=Color3.fromRGB(200,200,255)}, -- –≥–∞–ª–∞–∫—Ç–∏–∫–∞
	{bg=Color3.fromRGB(0,50,0), text=Color3.fromRGB(255,255,0)},   -- –Ω–æ–≤–æ—Ä—ñ—á–Ω–∞
	{bg=Color3.fromRGB(25,25,25), text=Color3.fromRGB(255,255,255)}-- –∫–ª–∞—Å–∏–∫–∞
}
local themeIndex = 1

local function applyTheme()
	local t = themes[themeIndex]
	UI.main.BackgroundColor3 = t.bg
	UI.title.TextColor3 = t.text
end
applyTheme()

-- ===== ESP =====
local function addESP(plr)
	if plr == player or not plr.Character then return end

	if highlights[plr] then
		highlights[plr]:Destroy()
	end

	local h = Instance.new("Highlight")
	h.FillColor = Color3.fromRGB(255,0,0)
	h.OutlineColor = Color3.fromRGB(255,255,255)
	h.FillTransparency = 0.4
	h.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
	h.Adornee = plr.Character
	h.Parent = plr.Character

	highlights[plr] = h
end

local function removeESP(plr)
	if highlights[plr] then
		highlights[plr]:Destroy()
		highlights[plr] = nil
	end
end

local function setupESP(plr)
	plr.CharacterAdded:Connect(function()
		task.wait(0.2)
		if espOn then addESP(plr) end
	end)
	plr.CharacterRemoving:Connect(function()
		removeESP(plr)
	end)
end

for _,p in pairs(Players:GetPlayers()) do setupESP(p) end
Players.PlayerAdded:Connect(setupESP)
Players.PlayerRemoving:Connect(removeESP)

-- ===== AIM HELPER (–±–µ–∑ —Å—Ç—Ä—ñ–ª—å–±–∏) =====
local function getTarget()
	local center = camera.ViewportSize/2
	local best, dist = nil, math.huge

	for _,plr in pairs(Players:GetPlayers()) do
		if plr~=player and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
			local hrp = plr.Character.HumanoidRootPart
			local pos, onscreen = camera:WorldToViewportPoint(hrp.Position)
			if onscreen then
				local d = (Vector2.new(pos.X,pos.Y)-center).Magnitude
				if d < dist then
					dist = d
					best = hrp
				end
			end
		end
	end
	return best
end

RunService.RenderStepped:Connect(function()
	if aimOn then
		local t = getTarget()
		if t then
			camera.CFrame = camera.CFrame:Lerp(
				CFrame.new(camera.CFrame.Position, t.Position),
				0.08
			)
		end
	end
end)

-- ===== TOGGLE –§–£–ù–ö–¶–Ü–á (–í–ê–ñ–õ–ò–í–û) =====
local function toggleESP()
	espOn = not espOn
	UI.esp.Text = espOn and "ESP: ON" or "ESP: OFF"

	if espOn then
		for _,p in pairs(Players:GetPlayers()) do addESP(p) end
	else
		for p,_ in pairs(highlights) do removeESP(p) end
	end
end

local function toggleAim()
	aimOn = not aimOn
	UI.aim.Text = aimOn and "AIM: ON" or "AIM: OFF"
end

-- ===== –ö–ù–û–ü–ö–ò =====
UI.esp.MouseButton1Click:Connect(toggleESP)
UI.aim.MouseButton1Click:Connect(toggleAim)
UI.hide.MouseButton1Click:Connect(function()
	guiVisible = not guiVisible
	UI.main.Visible = guiVisible
end)

-- ===== –¶–ò–§–†–ò (–¢–ï–ü–ï–† –ü–†–ê–¶–Æ–Ñ) =====
UIS.InputBegan:Connect(function(input, gp)
	if gp then return end

	if input.KeyCode == Enum.KeyCode.One then
		toggleESP()
	elseif input.KeyCode == Enum.KeyCode.Two then
		toggleAim()
	elseif input.KeyCode == Enum.KeyCode.Three then
		themeIndex += 1
		if themeIndex > #themes then themeIndex = 1 end
		applyTheme()
	elseif input.KeyCode == Enum.KeyCode.Four then
		guiVisible = not guiVisible
		UI.main.Visible = guiVisible
	end
end)
